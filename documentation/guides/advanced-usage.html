
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Advanced Usage - Map Controls Documentation</title>
  <link rel="stylesheet" href="/documentation/assets/styles.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/mermaid@10.0.0/dist/mermaid.min.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // Initialize syntax highlighting
      hljs.highlightAll();
      
      // Initialize mermaid diagrams
      mermaid.initialize({ 
        startOnLoad: true,
        theme: 'neutral',
        flowchart: { 
          useMaxWidth: true, 
          htmlLabels: true 
        }
      });
    });
  </script>
</head>
<body>
  <div class="container">
    <header>
      <h1>Advanced Usage</h1>
    </header>
    
    <nav class="main-nav">
      <ul>
        <li><a href="/documentation/index.html">Home</a></li>
        <li><a href="/documentation/guides/getting-started.html">Getting Started</a></li>
        <li><a href="/documentation/guides/installation.html">Installation</a></li>
        <li><a href="/documentation/api/index.html">API Reference</a></li>
        <li><a href="/documentation/examples/index.html">Examples</a></li>
        <li><a href="/documentation/guides/advanced-usage.html">Advanced Usage</a></li>
      </ul>
    </nav>
    
    <main>
      <h1 id="advanced-usage">Advanced Usage</h1>
<p>This guide covers advanced usage scenarios and customization options for the Map Controls module.</p>
<h2 id="custom-initialization">Custom Initialization</h2>
<h3 id="setting-initial-position">Setting Initial Position</h3>
<p>By default, the map is centered in the container when initialized. However, you can specify an initial position using the <code>initialPosition</code> option:</p>
<pre><code class="hljs language-typescript"><span class="hljs-keyword">const</span> mapControls = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MapControls</span>({
  <span class="hljs-attr">container</span>: <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;map-container&#x27;</span>),
  <span class="hljs-attr">mapSrc</span>: <span class="hljs-string">&#x27;path/to/map.jpg&#x27;</span>,
  <span class="hljs-attr">initialPosition</span>: { <span class="hljs-attr">x</span>: -<span class="hljs-number">500</span>, <span class="hljs-attr">y</span>: -<span class="hljs-number">300</span> } <span class="hljs-comment">// Start at specific coordinates</span>
});
</code></pre>
<p>This is useful when you want to focus on a specific area of the map when it first loads.</p>
<h3 id="custom-zoom-levels">Custom Zoom Levels</h3>
<p>You can customize the zoom behavior by setting the minimum and maximum zoom levels, as well as the initial zoom level:</p>
<pre><code class="hljs language-typescript"><span class="hljs-keyword">const</span> mapControls = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MapControls</span>({
  <span class="hljs-attr">container</span>: <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;map-container&#x27;</span>),
  <span class="hljs-attr">mapSrc</span>: <span class="hljs-string">&#x27;path/to/map.jpg&#x27;</span>,
  <span class="hljs-attr">initialZoom</span>: <span class="hljs-number">1.2</span>,  <span class="hljs-comment">// Start zoomed in slightly</span>
  <span class="hljs-attr">minZoom</span>: <span class="hljs-number">0.5</span>,      <span class="hljs-comment">// Minimum zoom level (zoomed out)</span>
  <span class="hljs-attr">maxZoom</span>: <span class="hljs-number">4</span>,        <span class="hljs-comment">// Maximum zoom level (zoomed in)</span>
  <span class="hljs-attr">zoomStep</span>: <span class="hljs-number">0.2</span>      <span class="hljs-comment">// Larger steps for zoom operations</span>
});
</code></pre>
<h2 id="custom-controls">Custom Controls</h2>
<h3 id="control-positioning">Control Positioning</h3>
<p>You can position the controls in one of four corners of the map:</p>
<pre><code class="hljs language-typescript"><span class="hljs-keyword">const</span> mapControls = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MapControls</span>({
  <span class="hljs-attr">container</span>: <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;map-container&#x27;</span>),
  <span class="hljs-attr">mapSrc</span>: <span class="hljs-string">&#x27;path/to/map.jpg&#x27;</span>,
  <span class="hljs-attr">showControls</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">controlsPosition</span>: <span class="hljs-string">&#x27;top-left&#x27;</span> <span class="hljs-comment">// &#x27;top-left&#x27;, &#x27;top-right&#x27;, &#x27;bottom-left&#x27;, or &#x27;bottom-right&#x27;</span>
});
</code></pre>
<h3 id="hiding-and-showing-controls">Hiding and Showing Controls</h3>
<p>You can programmatically hide and show the controls:</p>
<pre><code class="hljs language-typescript"><span class="hljs-comment">// Hide controls</span>
mapControls.<span class="hljs-title function_">hideControls</span>();

<span class="hljs-comment">// Show controls</span>
mapControls.<span class="hljs-title function_">showControls</span>();

<span class="hljs-comment">// Toggle controls</span>
<span class="hljs-keyword">let</span> controlsVisible = <span class="hljs-literal">true</span>;
<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;toggle-controls&#x27;</span>).<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">if</span> (controlsVisible) {
    mapControls.<span class="hljs-title function_">hideControls</span>();
  } <span class="hljs-keyword">else</span> {
    mapControls.<span class="hljs-title function_">showControls</span>();
  }
  controlsVisible = !controlsVisible;
});
</code></pre>
<h2 id="advanced-event-handling">Advanced Event Handling</h2>
<h3 id="custom-event-handling">Custom Event Handling</h3>
<p>You can create custom event handlers for more complex interactions:</p>
<pre><code class="hljs language-typescript"><span class="hljs-comment">// Track zoom history</span>
<span class="hljs-keyword">const</span> zoomHistory = [];

mapControls.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;zoom&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">level</span>) =&gt;</span> {
  zoomHistory.<span class="hljs-title function_">push</span>({
    level,
    <span class="hljs-attr">timestamp</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()
  });
  
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Zoom history: <span class="hljs-subst">${zoomHistory.length}</span> entries`</span>);
});

<span class="hljs-comment">// Track pan positions</span>
<span class="hljs-keyword">const</span> panPositions = [];

mapControls.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;pan&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">position</span>) =&gt;</span> {
  panPositions.<span class="hljs-title function_">push</span>({
    <span class="hljs-attr">x</span>: position.<span class="hljs-property">x</span>,
    <span class="hljs-attr">y</span>: position.<span class="hljs-property">y</span>,
    <span class="hljs-attr">timestamp</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()
  });
  
  <span class="hljs-comment">// Limit the history to last 10 positions</span>
  <span class="hljs-keyword">if</span> (panPositions.<span class="hljs-property">length</span> &gt; <span class="hljs-number">10</span>) {
    panPositions.<span class="hljs-title function_">shift</span>();
  }
});
</code></pre>
<h3 id="combining-multiple-events">Combining Multiple Events</h3>
<p>You can combine multiple events to create more complex behaviors:</p>
<pre><code class="hljs language-typescript"><span class="hljs-comment">// Create a state tracking object</span>
<span class="hljs-keyword">const</span> mapActivity = {
  <span class="hljs-attr">lastZoom</span>: <span class="hljs-number">1</span>,
  <span class="hljs-attr">lastPosition</span>: { <span class="hljs-attr">x</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">0</span> },
  <span class="hljs-attr">isActive</span>: <span class="hljs-literal">false</span>,
  <span class="hljs-attr">lastActiveTime</span>: <span class="hljs-literal">null</span>,
  <span class="hljs-attr">activityTimeout</span>: <span class="hljs-literal">null</span>
};

<span class="hljs-comment">// Track user activity</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">trackActivity</span>(<span class="hljs-params"></span>) {
  mapActivity.<span class="hljs-property">isActive</span> = <span class="hljs-literal">true</span>;
  mapActivity.<span class="hljs-property">lastActiveTime</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>();
  
  <span class="hljs-comment">// Reset the activity timeout</span>
  <span class="hljs-built_in">clearTimeout</span>(mapActivity.<span class="hljs-property">activityTimeout</span>);
  
  <span class="hljs-comment">// Set a new timeout to mark as inactive after 5 seconds</span>
  mapActivity.<span class="hljs-property">activityTimeout</span> = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
    mapActivity.<span class="hljs-property">isActive</span> = <span class="hljs-literal">false</span>;
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Map is now inactive&#x27;</span>);
  }, <span class="hljs-number">5000</span>);
}

<span class="hljs-comment">// Listen for events</span>
mapControls.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;zoom&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">level</span>) =&gt;</span> {
  mapActivity.<span class="hljs-property">lastZoom</span> = level;
  <span class="hljs-title function_">trackActivity</span>();
});

mapControls.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;pan&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">position</span>) =&gt;</span> {
  mapActivity.<span class="hljs-property">lastPosition</span> = position;
  <span class="hljs-title function_">trackActivity</span>();
});

<span class="hljs-comment">// Initial load</span>
mapControls.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;load&#x27;</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Map loaded, ready for interaction&#x27;</span>);
  mapActivity.<span class="hljs-property">lastZoom</span> = mapControls.<span class="hljs-title function_">getState</span>().<span class="hljs-property">zoom</span>;
  mapActivity.<span class="hljs-property">lastPosition</span> = mapControls.<span class="hljs-title function_">getState</span>().<span class="hljs-property">position</span>;
});
</code></pre>
<h2 id="extending-the-mapcontrols-class">Extending the MapControls Class</h2>
<p>You can extend the MapControls class to add custom functionality:</p>
<pre><code class="hljs language-typescript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">CustomMapControls</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">MapControls</span> {
  <span class="hljs-keyword">private</span> markers = [];
  
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">options</span>) {
    <span class="hljs-variable language_">super</span>(options);
    
    <span class="hljs-comment">// Add custom initialization</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;load&#x27;</span>, <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initializeMarkers</span>();
    });
  }
  
  <span class="hljs-comment">// Add a marker to the map</span>
  <span class="hljs-title function_">addMarker</span>(<span class="hljs-params">x, y, label</span>) {
    <span class="hljs-keyword">const</span> state = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getState</span>();
    <span class="hljs-keyword">const</span> marker = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;div&#x27;</span>);
    
    marker.<span class="hljs-property">className</span> = <span class="hljs-string">&#x27;map-marker&#x27;</span>;
    marker.<span class="hljs-property">textContent</span> = label;
    marker.<span class="hljs-property">style</span>.<span class="hljs-property">position</span> = <span class="hljs-string">&#x27;absolute&#x27;</span>;
    marker.<span class="hljs-property">style</span>.<span class="hljs-property">left</span> = <span class="hljs-string">`<span class="hljs-subst">${x}</span>px`</span>;
    marker.<span class="hljs-property">style</span>.<span class="hljs-property">top</span> = <span class="hljs-string">`<span class="hljs-subst">${y}</span>px`</span>;
    
    <span class="hljs-comment">// Add to the container</span>
    <span class="hljs-keyword">const</span> container = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getContainer</span>();
    container.<span class="hljs-title function_">appendChild</span>(marker);
    
    <span class="hljs-comment">// Store the marker</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">markers</span>.<span class="hljs-title function_">push</span>({ <span class="hljs-attr">element</span>: marker, x, y, label });
    
    <span class="hljs-comment">// Update marker positions</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateMarkerPositions</span>();
    
    <span class="hljs-keyword">return</span> marker;
  }
  
  <span class="hljs-comment">// Get the container element (new method)</span>
  <span class="hljs-title function_">getContainer</span>(<span class="hljs-params"></span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">container</span>; <span class="hljs-comment">// You might need to make container protected instead of private</span>
  }
  
  <span class="hljs-comment">// Initialize markers from data</span>
  <span class="hljs-title function_">initializeMarkers</span>(<span class="hljs-params"></span>) {
    <span class="hljs-comment">// Example: Load markers from a data source</span>
    <span class="hljs-keyword">const</span> markerData = [
      { <span class="hljs-attr">x</span>: <span class="hljs-number">100</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">150</span>, <span class="hljs-attr">label</span>: <span class="hljs-string">&#x27;A&#x27;</span> },
      { <span class="hljs-attr">x</span>: <span class="hljs-number">250</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">300</span>, <span class="hljs-attr">label</span>: <span class="hljs-string">&#x27;B&#x27;</span> },
      { <span class="hljs-attr">x</span>: <span class="hljs-number">400</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">200</span>, <span class="hljs-attr">label</span>: <span class="hljs-string">&#x27;C&#x27;</span> }
    ];
    
    markerData.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">marker</span> =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">addMarker</span>(marker.<span class="hljs-property">x</span>, marker.<span class="hljs-property">y</span>, marker.<span class="hljs-property">label</span>);
    });
  }
  
  <span class="hljs-comment">// Update marker positions based on current zoom and pan</span>
  <span class="hljs-title function_">updateMarkerPositions</span>(<span class="hljs-params"></span>) {
    <span class="hljs-keyword">const</span> state = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getState</span>();
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">markers</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">marker</span> =&gt;</span> {
      <span class="hljs-keyword">const</span> x = marker.<span class="hljs-property">x</span> * state.<span class="hljs-property">zoom</span> + state.<span class="hljs-property">position</span>.<span class="hljs-property">x</span>;
      <span class="hljs-keyword">const</span> y = marker.<span class="hljs-property">y</span> * state.<span class="hljs-property">zoom</span> + state.<span class="hljs-property">position</span>.<span class="hljs-property">y</span>;
      
      marker.<span class="hljs-property">element</span>.<span class="hljs-property">style</span>.<span class="hljs-property">transform</span> = <span class="hljs-string">`translate(<span class="hljs-subst">${x}</span>px, <span class="hljs-subst">${y}</span>px) scale(<span class="hljs-subst">${state.zoom}</span>)`</span>;
    });
  }
  
  <span class="hljs-comment">// Override the render method to update markers</span>
  <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) {
    <span class="hljs-variable language_">super</span>.<span class="hljs-title function_">render</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateMarkerPositions</span>();
  }
}
</code></pre>
<h2 id="integration-with-other-libraries">Integration with Other Libraries</h2>
<h3 id="using-with-react">Using with React</h3>
<pre><code class="hljs language-jsx"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>, { useEffect, useRef } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">MapControls</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;map-controls&#x27;</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">MapComponent</span>(<span class="hljs-params">{ mapSrc, onZoomChange, onPanChange }</span>) {
  <span class="hljs-keyword">const</span> containerRef = <span class="hljs-title function_">useRef</span>(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> mapControlsRef = <span class="hljs-title function_">useRef</span>(<span class="hljs-literal">null</span>);
  
  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-comment">// Initialize map controls when the component mounts</span>
    <span class="hljs-keyword">if</span> (containerRef.<span class="hljs-property">current</span>) {
      mapControlsRef.<span class="hljs-property">current</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MapControls</span>({
        <span class="hljs-attr">container</span>: containerRef.<span class="hljs-property">current</span>,
        <span class="hljs-attr">mapSrc</span>: mapSrc,
        <span class="hljs-attr">initialZoom</span>: <span class="hljs-number">1</span>,
        <span class="hljs-attr">showControls</span>: <span class="hljs-literal">true</span>
      });
      
      <span class="hljs-comment">// Set up event listeners</span>
      mapControlsRef.<span class="hljs-property">current</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;zoom&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">level</span>) =&gt;</span> {
        <span class="hljs-keyword">if</span> (onZoomChange) {
          <span class="hljs-title function_">onZoomChange</span>(level);
        }
      });
      
      mapControlsRef.<span class="hljs-property">current</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;pan&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">position</span>) =&gt;</span> {
        <span class="hljs-keyword">if</span> (onPanChange) {
          <span class="hljs-title function_">onPanChange</span>(position);
        }
      });
    }
    
    <span class="hljs-comment">// Clean up when the component unmounts</span>
    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-keyword">if</span> (mapControlsRef.<span class="hljs-property">current</span>) {
        mapControlsRef.<span class="hljs-property">current</span>.<span class="hljs-title function_">destroy</span>();
      }
    };
  }, [mapSrc, onZoomChange, onPanChange]);
  
  <span class="hljs-keyword">return</span> (
    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;map-container&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">{containerRef}</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">width:</span> &#x27;<span class="hljs-attr">100</span>%&#x27;, <span class="hljs-attr">height:</span> &#x27;<span class="hljs-attr">500px</span>&#x27; }}&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">MapComponent</span>;
</code></pre>
<h3 id="using-with-vuejs">Using with Vue.js</h3>
<pre><code class="hljs language-vue">&lt;template&gt;
  &lt;div class=&quot;map-container&quot; ref=&quot;mapContainer&quot;&gt;&lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
import { MapControls } from &#x27;map-controls&#x27;;

export default {
  name: &#x27;MapComponent&#x27;,
  props: {
    mapSrc: {
      type: String,
      required: true
    }
  },
  data() {
    return {
      mapControls: null
    };
  },
  mounted() {
    // Initialize map controls
    this.mapControls = new MapControls({
      container: this.$refs.mapContainer,
      mapSrc: this.mapSrc,
      initialZoom: 1,
      showControls: true
    });
    
    // Set up event listeners
    this.mapControls.on(&#x27;zoom&#x27;, this.handleZoom);
    this.mapControls.on(&#x27;pan&#x27;, this.handlePan);
  },
  beforeDestroy() {
    // Clean up
    if (this.mapControls) {
      this.mapControls.off(&#x27;zoom&#x27;, this.handleZoom);
      this.mapControls.off(&#x27;pan&#x27;, this.handlePan);
      this.mapControls.destroy();
    }
  },
  methods: {
    handleZoom(level) {
      this.$emit(&#x27;zoom-change&#x27;, level);
    },
    handlePan(position) {
      this.$emit(&#x27;pan-change&#x27;, position);
    },
    zoomIn() {
      if (this.mapControls) {
        this.mapControls.zoomIn();
      }
    },
    zoomOut() {
      if (this.mapControls) {
        this.mapControls.zoomOut();
      }
    },
    reset() {
      if (this.mapControls) {
        this.mapControls.reset();
      }
    }
  }
};
&lt;/script&gt;

&lt;style scoped&gt;
.map-container {
  width: 100%;
  height: 500px;
  position: relative;
}
&lt;/style&gt;
</code></pre>
<h2 id="performance-optimization">Performance Optimization</h2>
<h3 id="debouncing-events">Debouncing Events</h3>
<p>For better performance, you can debounce event handlers to reduce the frequency of updates:</p>
<pre><code class="hljs language-typescript"><span class="hljs-comment">// Utility function for debouncing</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">debounce</span>(<span class="hljs-params">func, wait</span>) {
  <span class="hljs-keyword">let</span> timeout;
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params">...args</span>) {
    <span class="hljs-keyword">const</span> context = <span class="hljs-variable language_">this</span>;
    <span class="hljs-built_in">clearTimeout</span>(timeout);
    timeout = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> func.<span class="hljs-title function_">apply</span>(context, args), wait);
  };
}

<span class="hljs-comment">// Create debounced handlers</span>
<span class="hljs-keyword">const</span> debouncedZoomHandler = <span class="hljs-title function_">debounce</span>(<span class="hljs-function">(<span class="hljs-params">level</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Debounced zoom level: <span class="hljs-subst">${level}</span>`</span>);
  <span class="hljs-comment">// Update UI or perform other operations</span>
}, <span class="hljs-number">100</span>);

<span class="hljs-keyword">const</span> debouncedPanHandler = <span class="hljs-title function_">debounce</span>(<span class="hljs-function">(<span class="hljs-params">position</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Debounced position: <span class="hljs-subst">${position.x}</span>, <span class="hljs-subst">${position.y}</span>`</span>);
  <span class="hljs-comment">// Update UI or perform other operations</span>
}, <span class="hljs-number">100</span>);

<span class="hljs-comment">// Add event listeners</span>
mapControls.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;zoom&#x27;</span>, debouncedZoomHandler);
mapControls.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;pan&#x27;</span>, debouncedPanHandler);
</code></pre>
<h3 id="optimizing-for-large-maps">Optimizing for Large Maps</h3>
<p>When working with very large maps, consider these optimizations:</p>
<ol>
<li><strong>Lazy Loading</strong>: Load map sections as needed instead of the entire map at once</li>
<li><strong>Image Optimization</strong>: Use optimized image formats and compression</li>
<li><strong>Canvas Rendering</strong>: Use the canvas renderer for better performance with large images</li>
<li><strong>Throttle Events</strong>: Throttle pan and zoom events to reduce rendering frequency</li>
</ol>
<pre><code class="hljs language-typescript"><span class="hljs-comment">// Example of implementing lazy loading with multiple map tiles</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">TiledMapControls</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">MapControls</span> {
  <span class="hljs-keyword">private</span> tiles = [];
  <span class="hljs-keyword">private</span> tileSize = <span class="hljs-number">256</span>;
  <span class="hljs-keyword">private</span> loadedTiles = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>();
  
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">options</span>) {
    <span class="hljs-variable language_">super</span>(options);
    
    <span class="hljs-comment">// Override the mapSrc with a base URL for tiles</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">tileBaseUrl</span> = options.<span class="hljs-property">tileBaseUrl</span> || <span class="hljs-string">&#x27;&#x27;</span>;
    
    <span class="hljs-comment">// Listen for pan and zoom events to load tiles</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;pan&#x27;</span>, <span class="hljs-title function_">debounce</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateVisibleTiles</span>(), <span class="hljs-number">200</span>));
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;zoom&#x27;</span>, <span class="hljs-title function_">debounce</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateVisibleTiles</span>(), <span class="hljs-number">200</span>));
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;load&#x27;</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateVisibleTiles</span>());
  }
  
  <span class="hljs-comment">// Calculate which tiles are visible and load them</span>
  <span class="hljs-title function_">updateVisibleTiles</span>(<span class="hljs-params"></span>) {
    <span class="hljs-keyword">const</span> state = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getState</span>();
    <span class="hljs-keyword">const</span> visibleTiles = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">calculateVisibleTiles</span>(state);
    
    <span class="hljs-comment">// Load new tiles</span>
    visibleTiles.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">tile</span> =&gt;</span> {
      <span class="hljs-keyword">const</span> tileKey = <span class="hljs-string">`<span class="hljs-subst">${tile.x}</span>,<span class="hljs-subst">${tile.y}</span>,<span class="hljs-subst">${tile.z}</span>`</span>;
      
      <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">loadedTiles</span>.<span class="hljs-title function_">has</span>(tileKey)) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">loadTile</span>(tile.<span class="hljs-property">x</span>, tile.<span class="hljs-property">y</span>, tile.<span class="hljs-property">z</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">loadedTiles</span>.<span class="hljs-title function_">add</span>(tileKey);
      }
    });
  }
  
  <span class="hljs-comment">// Calculate which tiles are visible based on current state</span>
  <span class="hljs-title function_">calculateVisibleTiles</span>(<span class="hljs-params">state</span>) {
    <span class="hljs-comment">// Implementation depends on your tiling scheme</span>
    <span class="hljs-comment">// This is a simplified example</span>
    <span class="hljs-keyword">const</span> visibleTiles = [];
    <span class="hljs-keyword">const</span> zoom = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(state.<span class="hljs-property">zoom</span>);
    
    <span class="hljs-comment">// Calculate tile coordinates based on position and zoom</span>
    <span class="hljs-keyword">const</span> startX = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(-state.<span class="hljs-property">position</span>.<span class="hljs-property">x</span> / (<span class="hljs-variable language_">this</span>.<span class="hljs-property">tileSize</span> * state.<span class="hljs-property">zoom</span>));
    <span class="hljs-keyword">const</span> startY = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(-state.<span class="hljs-property">position</span>.<span class="hljs-property">y</span> / (<span class="hljs-variable language_">this</span>.<span class="hljs-property">tileSize</span> * state.<span class="hljs-property">zoom</span>));
    <span class="hljs-keyword">const</span> endX = startX + <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">ceil</span>(state.<span class="hljs-property">containerSize</span>.<span class="hljs-property">width</span> / (<span class="hljs-variable language_">this</span>.<span class="hljs-property">tileSize</span> * state.<span class="hljs-property">zoom</span>));
    <span class="hljs-keyword">const</span> endY = startY + <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">ceil</span>(state.<span class="hljs-property">containerSize</span>.<span class="hljs-property">height</span> / (<span class="hljs-variable language_">this</span>.<span class="hljs-property">tileSize</span> * state.<span class="hljs-property">zoom</span>));
    
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> x = startX; x &lt;= endX; x++) {
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> y = startY; y &lt;= endY; y++) {
        visibleTiles.<span class="hljs-title function_">push</span>({ x, y, <span class="hljs-attr">z</span>: zoom });
      }
    }
    
    <span class="hljs-keyword">return</span> visibleTiles;
  }
  
  <span class="hljs-comment">// Load a specific tile</span>
  <span class="hljs-title function_">loadTile</span>(<span class="hljs-params">x, y, z</span>) {
    <span class="hljs-keyword">const</span> tileUrl = <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.tileBaseUrl}</span>/<span class="hljs-subst">${z}</span>/<span class="hljs-subst">${x}</span>/<span class="hljs-subst">${y}</span>.png`</span>;
    <span class="hljs-keyword">const</span> tile = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;img&#x27;</span>);
    
    tile.<span class="hljs-property">src</span> = tileUrl;
    tile.<span class="hljs-property">style</span>.<span class="hljs-property">position</span> = <span class="hljs-string">&#x27;absolute&#x27;</span>;
    tile.<span class="hljs-property">style</span>.<span class="hljs-property">left</span> = <span class="hljs-string">`<span class="hljs-subst">${x * <span class="hljs-variable language_">this</span>.tileSize}</span>px`</span>;
    tile.<span class="hljs-property">style</span>.<span class="hljs-property">top</span> = <span class="hljs-string">`<span class="hljs-subst">${y * <span class="hljs-variable language_">this</span>.tileSize}</span>px`</span>;
    tile.<span class="hljs-property">style</span>.<span class="hljs-property">width</span> = <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.tileSize}</span>px`</span>;
    tile.<span class="hljs-property">style</span>.<span class="hljs-property">height</span> = <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.tileSize}</span>px`</span>;
    
    <span class="hljs-comment">// Add to the container</span>
    <span class="hljs-keyword">const</span> container = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getContainer</span>();
    container.<span class="hljs-title function_">appendChild</span>(tile);
    
    <span class="hljs-comment">// Store the tile</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">tiles</span>.<span class="hljs-title function_">push</span>(tile);
  }
}
</code></pre>
<h2 id="see-also">See Also</h2>
<ul>
<li><a href="../api/index.md">API Reference</a></li>
<li><a href="../examples/index.md">Examples</a></li>
<li><a href="extending.md">Extending the Module</a></li>
</ul>

    </main>
    
    <footer class="footer">
      <p>Map Controls is licensed under the MIT License.</p>
      <p>Documentation generated on 5/18/2025</p>
    </footer>
  </div>
</body>
</html>
